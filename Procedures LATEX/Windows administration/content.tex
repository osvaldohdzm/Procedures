
%----------------------------------------------------------------------------------------
%	SECTIONS
%----------------------------------------------------------------------------------------


\section{Introducción}
Administración de sistemas windows

￼


Configuración de entorno virtual paython


pip install virtualenv

After running the command, check if virtualenv is installed on your system. The following command displays the version of virtualenv if it is successfully installed on the system.

virtualenv –version

Once virtualenv is installed, we can use it to create virtual environments for our projects. Creating a virtual environment through virtualenv is quite easy. The following command serves the purpose.

virtualenv venv

Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

choco install 7zip.install
choco uninstall python --pre 


choco install python 




Get-WindowsCapability -Online | Where-Object Name -like 'OpenSSH*'


Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0

New-ItemProperty -Path "HKLM:\SOFTWARE\OpenSSH" -Name DefaultShell -Value "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -PropertyType String -Force



 ssh cognitech01@192.168.100.10



Get-Process notepad, msedge

 Stop-Process -Name "notepad"


Get-MpComputerStatus
Get-MpComputerStatus | select RealTimeProtectionEnabled
Set-MpPreference -DisableRealtimeMonitoring $false


([Security.Principal.WindowsPrincipal] `
  [Security.Principal.WindowsIdentity]::GetCurrent() `
).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)


Get-WmiObject -Class Win32_Product | Select-Object -Property Name


Get-WmiObject -Class Win32_Product | Select-Object -Property Name | Select-String "Visual"

regedit
Equipo\HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\PowerPoint\Options

ExportBitmapResolution
En 300

openssl enc -base64 -in .\evidencia.png -A | Set-Clipboard




Install ngrok

choco install ngrok

ngrok
set static ip
nvim


Kali Subsystem


\begin{lstlisting}[numbers=none]
	sudo cat /etc/resolv.conf
\end{lstlisting}
 
\begin{lstlisting}[numbers=none]
	sudo touch /etc/resolv.conf && sudo chmod 777 /etc/resolv.conf  && sudo echo "nameserver 172.18.206.36" > /etc/resolv.conf && sudo echo "nameserver 172.18.206.37" >> /etc/resolv.conf && sudo echo "nameserver 8.8.8.8" >> /etc/resolv.conf && sudo echo "nameserver 8.8.4.4" >>  /etc/resolv.conf && sudo chattr +i /etc/resolv.conf
\end{lstlisting}
 
Make chagnes permanten 
\begin{lstlisting}[numbers=none]
sudo bash -c 'echo "[network]" > /etc/wsl.conf' && sudo bash -c 'echo "generateResolvConf = false" >> /etc/wsl.conf'
\end{lstlisting}

And on powershjell Administración
\begin{lstlisting}[numbers=none]
	wsl.exe --shutdown
	wsl.exe
\end{lstlisting}



New-NetFirewallRule -DisplayName 'HTTP-Inbound' -Profile @('Domain', 'Private') -Direction Inbound -Action Allow -Protocol TCP -LocalPort @('80', '443', '8080')

New-NetFirewallRule -DisplayName "Allow inbound ICMPv4" -Direction Inbound -Protocol ICMPv4 -IcmpType 8 -RemoteAddress $ips -Action Allow

Start-Service -Name "SecoClientService"